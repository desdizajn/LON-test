# Knowledge Base –ö–æ–Ω—Ü–µ–ø—Ç –∑–∞ LON –°–∏—Å—Ç–µ–º

## –ê–Ω–∞–ª–∏–∑–∞ –Ω–∞ –ø–æ—Å—Ç–æ–µ—á–∫–∏ —Ä–µ—Å—É—Ä—Å–∏

### üìä –ü–æ–¥–∞—Ç–æ—Ü–∏ –≤–æ `kb/Raw_Files/`:

#### 1. **–†–µ–≥—É–ª–∞—Ç–∏–≤–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏** (PDF - 15MB total)
- `–ó–∞–∫–æ–Ω –∑–∞ —Ü–∞—Ä–∏–Ω–µ—ö–µ.pdf` (1.0MB) - –û—Å–Ω–æ–≤–µ–Ω –∑–∞–∫–æ–Ω—Å–∫–∏ –æ–∫–≤–∏—Ä
- `–£–†–ï–î–ë–ê –ó–ê –°–ü–†–û–í–ï–î–£–í–ê–ä–ï –ù–ê –¶–ê–†–ò–ù–°–ö–ò–û–¢ –ó–ê–ö–û–ù.pdf` (1.3MB) - –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞
- `–ü–†–ê–í–ò–õ–ù–ò–ö –ó–ê –ù–ê–ß–ò–ù–û–¢ –ù–ê –ü–û–ü–û–õ–ù–£–í–ê–ä–ï –ù–ê –¶–ê–†–ò–ù–°–ö–ê–¢–ê –î–ï–ö–õ–ê–†–ê–¶–ò–à–ê.pdf` (826KB, 168 —Å—Ç—Ä–∞–Ω–∏—Ü–∏) - **–ö–†–ò–¢–ò–ß–ï–ù** –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞
- `UREDBA_ZA_AVTONOMNI_MERKI___119-2005_.pdf` (145KB)
- `PravilnikVidNadomestociPrecistenTekst.pdf` (267KB)

#### 2. **–£–ø–∞—Ç—Å—Ç–≤–∞ –∏ –ø—Ä–∏—Ä–∞—á–Ω–∏—Ü–∏**
- `TraderManual_CALC_EN_v.1.4_mk.pdf` (2.0MB) - CALC —Å–∏—Å—Ç–µ–º –º–∞–Ω—É–∞–ª
- `–ü—Ä–∏—Ä–∞—á–Ω–∏–∫ –∑–∞ –¢–ê–†–ò–ú.pdf` (2.2MB) - TARIC —É–ø–∞—Ç—Å—Ç–≤–æ
- `P2MK1_4_1.1.MK1_upatstvo_za_carinska_vrednost.pdf` (1.8MB) - –í—Ä–µ–¥–Ω—É–≤–∞—ö–µ
- `P2MK1.4.1.1.MK2_deklaracija_na_vrednost.pdf` (334KB)

#### 3. **–ü—Ä–æ—Ü–µ—Å–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏**
- `uvoz.za.oblagoroduvanje.pdf` (1.7MB) - –û–±–ª–∞–≥–æ—Ä–æ–¥—É–≤–∞—ö–µ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏
- `–£–≤–æ–∑ –∑–∞ –æ–±–ª–∞–≥–æ—Ä–æ–¥—É–≤–∞—ö–µ.docx` (17KB)
- `Povtore_izvoz_nasoka_07062019.pdf` (372KB) - –ü–æ–≤—Ç–æ—Ä–µ–Ω –∏–∑–≤–æ–∑
- `Podadok_za_razdolzuvanje_garancija.pdf` (66KB) - –ì–∞—Ä–∞–Ω—Ü–∏–∏
- `prilozi.uvoz28.02.doc` (450KB) - –ü—Ä–∏–ª–æ–∑–∏ –∑–∞ —É–≤–æ–∑

#### 4. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω–∏ –ø–æ–¥–∞—Ç–æ—Ü–∏** (Excel)
- **`TARIC.xlsx`** (1.2MB)
  - **10,307 –∑–∞–ø–∏—Å–∏** - —Ç–∞—Ä–∏—Ñ–Ω–∏ –æ–∑–Ω–∞–∫–∏
  - 21 –∫–æ–ª–æ–Ω–∏: Tariff number, Description, Customs rate, VAT, Unit measure, –∏—Ç–Ω.
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω–∏ —Ü–∞—Ä–∏–Ω—Å–∫–∏ —Å—Ç–∞–ø–∫–∏ –∏ –º–µ—Ä–Ω–∏ –µ–¥–∏–Ω–∏—Ü–∏
  
- **`Spisok na Regulativi KN 15.xlsx`** (807KB)
  - **1,809 —Ä–µ–≥—É–ª–∞—Ç–∏–≤–∏** - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ —Ä–∞—Å–ø–æ—Ä–µ–¥—É–≤–∞—ö–∞ –Ω–∞ —Å—Ç–æ–∫–∏
  - CELEX –±—Ä–æ—ò, —Ç–∞—Ä–∏—Ñ–Ω–∞ –æ–∑–Ω–∞–∫–∞, –æ–ø–∏—Å –Ω–∞ –º–∞–∫–µ–¥–æ–Ω—Å–∫–∏ –∏ –∞–Ω–≥–ª–∏—Å–∫–∏
  - –ü—Ä–∞–≤–µ–Ω –æ—Å–Ω–æ–≤ –Ω–∞ —Ä–∞—Å–ø–æ—Ä–µ–¥—É–≤–∞—ö–µ

---

## üéØ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω –ö–æ–Ω—Ü–µ–ø—Ç: Multi-Layer Knowledge Base Architecture

### –°–ª–æ—ò 1: **Structured Data Layer** (SQL Database)
–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω–∏ –ø–æ–¥–∞—Ç–æ—Ü–∏ –∫–æ–∏ —Å–µ –¥–∏—Ä–µ–∫—Ç–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–∞–Ω–∏ –≤–æ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞—Ç–∞.

#### –¢–∞–±–µ–ª–∏:
```sql
-- –í–µ—ú–µ –ø–æ—Å—Ç–æ–∏: Items, UoM, Warehouses

-- –ù–æ–≤–æ: TARIC –±–∞–∑–∞
CREATE TABLE TariffCodes (
    Id uniqueidentifier PRIMARY KEY,
    TariffNumber nvarchar(10) NOT NULL UNIQUE,
    TARBR nvarchar(4),
    Description nvarchar(500),
    CustomsRate decimal(5,2),
    VATRate decimal(5,2),
    UnitMeasure nvarchar(10),
    IsActive bit DEFAULT 1
);

-- –†–µ–≥—É–ª–∞—Ç–∏–≤–∏ –∏ —Å–ø–µ—Ü–∏—ò–∞–ª–Ω–∏ —Ä–µ–∂–∏–º–∏
CREATE TABLE CustomsRegulations (
    Id uniqueidentifier PRIMARY KEY,
    CelexNumber nvarchar(50),
    OfficialGazetteRef nvarchar(100),
    TariffNumber nvarchar(10),
    DescriptionMK nvarchar(max),
    DescriptionEN nvarchar(max),
    LegalBasis nvarchar(max),
    EffectiveDate datetime2,
    ExpiryDate datetime2 NULL
);

-- –ü—Ä–∞–≤–∏–ª–∞ –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ (–∏–∑–≤–ª–µ—á–µ–Ω–∏ –æ–¥ –ø—Ä–∞–≤–∏–ª–Ω–∏–∫)
CREATE TABLE DeclarationRules (
    Id uniqueidentifier PRIMARY KEY,
    RuleCode nvarchar(50) UNIQUE,
    FieldName nvarchar(100), -- Box01, Box02, etc.
    RuleType nvarchar(50), -- Required, Format, CrossField, ValueList
    ValidationLogic nvarchar(max), -- JSON or SQL expression
    ErrorMessage nvarchar(500),
    Severity nvarchar(20), -- Error, Warning, Info
    ReferenceDocument nvarchar(200),
    IsActive bit DEFAULT 1
);

-- –ö–æ–¥ –ª–∏—Å—Ç–∏ (—à–∏—Ñ—Ä–∏ –æ–¥ –ø—Ä–∞–≤–∏–ª–Ω–∏–∫)
CREATE TABLE CodeLists (
    Id uniqueidentifier PRIMARY KEY,
    ListType nvarchar(50), -- ProcedureCode, DocumentType, Country, etc.
    Code nvarchar(20),
    DescriptionMK nvarchar(200),
    DescriptionEN nvarchar(200),
    ParentCode nvarchar(20) NULL, -- –ó–∞ —Ö–∏–µ—Ä–∞—Ä—Ö–∏—Å–∫–∏ –ª–∏—Å—Ç–∏
    IsActive bit DEFAULT 1,
    UNIQUE (ListType, Code)
);
```

**–ò–∑–≤–æ—Ä**: `TARIC.xlsx`, `Spisok na Regulativi KN 15.xlsx`

---

### –°–ª–æ—ò 2: **Rule Engine Layer** (Business Logic)
Smart –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∫–æ—ò–∞ –∞–≤—Ç–æ–º–∞—Ç—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—É–≤–∞ compliance.

#### –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:
```csharp
// LON.Application/Customs/Validators/DeclarationValidator.cs
public class DeclarationRuleEngine
{
    public ValidationResult ValidateDeclaration(CustomsDeclaration declaration)
    {
        // 1. Field-level validation (—Ñ–æ—Ä–º–∞—Ç–∏, –∑–∞–¥–æ–ª–∂–∏—Ç–µ–ª–Ω–∏ –ø–æ–ª–∏—ö–∞)
        // 2. Cross-field validation (Box 40 –º–æ—Ä–∞ –¥–∞ –æ–¥–≥–æ–≤–∞—Ä–∞ –Ω–∞ Box 33)
        // 3. Regulatory compliance (–¥–∞–ª–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –µ –¥–æ–∑–≤–æ–ª–µ–Ω–∞ –∑–∞ —Ç–∞—Ä–∏—Ñ–∞)
        // 4. Data consistency (—Å—É–º–∏, –µ–¥–∏–Ω–∏—Ü–∏, –∏—Ç–Ω.)
    }
}
```

**–ü—Ä–∏–º–µ—Ä–∏ –Ω–∞ –ø—Ä–∞–≤–∏–ª–∞**:
- Box 40: Duty rate –º–æ—Ä–∞ –¥–∞ –æ–¥–≥–æ–≤–∞—Ä–∞ –Ω–∞ TARIC —Ç–∞–±–µ–ª–∞ –∑–∞ –¥–∞–¥–µ–Ω–∞—Ç–∞ —Ç–∞—Ä–∏—Ñ–Ω–∞ –æ–∑–Ω–∞–∫–∞
- Box 33: Commodity code –º–æ—Ä–∞ –¥–∞ –±–∏–¥–µ –≤–∞–ª–∏–¥–µ–Ω 10-—Ü–∏—Ñ—Ä–µ–Ω TARIC –∫–æ–¥
- Box 37: Procedure code –º–æ—Ä–∞ –¥–∞ –µ –æ–¥ –æ–¥–æ–±—Ä–µ–Ω–∞—Ç–∞ –ª–∏—Å—Ç–∞ (40 00, 42 00, 51 00...)
- Box 44: Documents –º–æ—Ä–∞ –¥–∞ —Å–µ –æ–¥ –¥–æ–∑–≤–æ–ª–µ–Ω–∏ —Ç–∏–ø–æ–≤–∏ (N380, N703, N730...)

---

### –°–ª–æ—ò 3: **Document Vector Store** (RAG - Retrieval Augmented Generation)
–°–µ–º–∞–Ω—Ç–∏—á–∫–æ –ø—Ä–µ–±–∞—Ä—É–≤–∞—ö–µ –Ω–∏–∑ —Ä–µ–≥—É–ª–∞—Ç–∏–≤–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏ –∑–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–Ω–∞ –ø–æ–º–æ—à.

#### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—ò–∞:
- **Vector Database**: pgvector (PostgreSQL extension) –∏–ª–∏ Azure AI Search
- **Embeddings**: OpenAI text-embedding-3-small –∏–ª–∏ –ª–æ–∫–∞–ª–µ–Ω –º–æ–¥–µ–ª
- **Chunking Strategy**: 
  - –ü—Ä–∞–≤–∏–ª–Ω–∏–∫: –ø–æ —á–ª–µ–Ω (Article-level chunks)
  - –£–ø–∞—Ç—Å—Ç–≤–∞: –ø–æ —Å–µ–∫—Ü–∏—ò–∞/–ø–æ–¥–∑–∞–≥–ª–∞–≤–∏–µ
  - –ü—Ä–∏—Ä–∞—á–Ω–∏—Ü–∏: –ø–æ —Ç–µ–º–∏ (procedure-specific)

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
```json
{
  "chunk_id": "pravilnik_chlen_15",
  "document_source": "–ü–†–ê–í–ò–õ–ù–ò–ö –ó–ê –ù–ê–ß–ò–ù–û–¢ –ù–ê –ü–û–ü–û–õ–ù–£–í–ê–ä–ï",
  "section": "–ß–ª–µ–Ω 15 - Box 33 (Commodity Code)",
  "content": "–¢–∞—Ä–∏—Ñ–Ω–∞—Ç–∞ –æ–∑–Ω–∞–∫–∞ —Å–µ —Å–æ—Å—Ç–æ–∏ –æ–¥ 10 —Ü–∏—Ñ—Ä–∏...",
  "metadata": {
    "article": 15,
    "box_number": 33,
    "category": "validation_rule",
    "effective_date": "2019-06-01"
  },
  "embedding": [0.123, -0.456, ...] // 1536 dimensions
}
```

---

### –°–ª–æ—ò 4: **AI Assistant Layer** (User-facing)
–ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –∞—Å–∏—Å—Ç–µ–Ω—Ç –∫–æ—ò –ø–æ–º–∞–≥–∞ –Ω–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç –∑–∞ –≤—Ä–µ–º–µ –Ω–∞ –ø–æ–ø–æ–ª–Ω—É–≤–∞—ö–µ.

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç–∏:

1. **Contextual Help** (–ü–æ–º–æ—à –ø–æ –ø–æ–ª–∏—ö–∞)
   ```
   User: –®—Ç–æ —Ç—Ä–µ–±–∞ –¥–∞ –≤–Ω–µ—Å–∞–º –≤–æ Box 40?
   AI: Box 40 —Å–æ–¥—Ä–∂–∏ —Ü–∞—Ä–∏–Ω—Å–∫–∏ –Ω–∞–¥–æ–º–µ—Å—Ç –∑–∞ –≤–∞—à–∞—Ç–∞ —Å—Ç–æ–∫–∞. 
       –ó–∞ —Ç–∞—Ä–∏—Ñ–∞ 0101210000 (–∂–∏–≤–∏ –∫–æ—ö–∏), —Å—Ç–∞–ø–∫–∞—Ç–∞ –µ 0% 
       —Å–ø–æ—Ä–µ–¥ TARIC.
       –†–µ—Ñ–µ—Ä–µ–Ω—Ü–∞: –ü—Ä–∞–≤–∏–ª–Ω–∏–∫, –ß–ª–µ–Ω 47
   ```

2. **Smart Validation** (Real-time)
   ```
   User: [–≤–Ω–µ—Å—É–≤–∞ commodity code 0101999999]
   AI: ‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª–µ–Ω –∫–æ–¥! –¢–∞—Ä–∏—Ñ–Ω–∞ –æ–∑–Ω–∞–∫–∞ 0101999999 –Ω–µ 
       –ø–æ—Å—Ç–æ–∏ –≤–æ TARIC –±–∞–∑–∞—Ç–∞. –î–∞–ª–∏ –º–∏—Å–ª–µ–≤—Ç–µ –Ω–∞:
       - 0101299000 (–î—Ä—É–≥–∏ –∫–æ—ö–∏, –∂–∏–≤–∏)
       - 0101300000 (–ú–∞–≥–∞—Ä–∏—ö–∞, –∂–∏–≤–∏)?
   ```

3. **Document Suggestions** (–ê–≤—Ç–æ–º–∞—Ç—Å–∫–æ –ø—Ä–µ–ø–æ–∑–Ω–∞–≤–∞—ö–µ)
   ```
   System: [–¥–µ—Ç–µ–∫—Ç–∏—Ä–∞ procedure code "42 00" - –æ–±–ª–∞–≥–æ—Ä–æ–¥—É–≤–∞—ö–µ]
   AI: üí° –ó–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ 42 00 (—É–≤–æ–∑ –∑–∞ –æ–±–ª–∞–≥–æ—Ä–æ–¥—É–≤–∞—ö–µ) –≤–∏ 
       —Ç—Ä–µ–±–∞:
       ‚úì –û–¥–æ–±—Ä–µ–Ω–∏–µ (Document N730)
       ‚úì –ü—Ä–æ—Ñ–æ—Ä–º–∞ —Ñ–∞–∫—Ç—É—Ä–∞
       ‚úì –¢—Ä–≥–æ–≤—Å–∫–∏ –¥–æ–≥–æ–≤–æ—Ä
       –†–µ—Ñ–µ—Ä–µ–Ω—Ü–∞: uvoz.za.oblagoroduvanje.pdf, —Å—Ç—Ä. 12
   ```

4. **Regulatory Updates** (–ò–∑–≤–µ—Å—Ç—É–≤–∞—ö–∞)
   ```
   AI: ‚ìò –ù–æ–≤–∞ —Ä–µ–≥—É–ª–∞—Ç–∏–≤–∞ (CELEX 32013R0729) –≤–ª–µ–≥—É–≤–∞ –Ω–∞ —Å–∏–ª–∞ –æ–¥ 
       01.01.2026 –∏ –≤–ª–∏—ò–∞–µ –Ω–∞ —Ç–∞—Ä–∏—Ñ–∞ 0307 99 80. 
       –ü—Ä–µ–≥–ª–µ–¥: [link]
   ```

5. **Procedure Wizard** (–í–æ–¥–∏—á —á–µ–∫–æ—Ä-–ø–æ-—á–µ–∫–æ—Ä)
   ```
   AI: –ò–∑–≥–ª–µ–¥–∞ –¥–µ–∫–∞ –ø—Ä–∏—ò–∞–≤—É–≤–∞—Ç–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω –∏–∑–≤–æ–∑. –ê—ò–¥–µ —á–µ–∫–æ—Ä –ø–æ —á–µ–∫–æ—Ä:
       1Ô∏è‚É£ –í–Ω–µ—Å–µ—Ç–µ –±—Ä–æ—ò –Ω–∞ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–∞ —É–≤–æ–∑–Ω–∞ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—ò–∞
       2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞: –ì–∞—Ä–∞–Ω—Ü–∏—ò–∞—Ç–∞ —Ç—Ä–µ–±–∞ –¥–∞ –µ —Ä–∞–∑–¥–æ–ª–∂–µ–Ω–∞
       3Ô∏è‚É£ –î–æ–∫—É–º–µ–Ω—Ç N785 (–∏–∑–≤–æ–∑–Ω–∞ –¥–æ–∑–≤–æ–ª–∞) –µ –∑–∞–¥–æ–ª–∂–∏—Ç–µ–ª–µ–Ω
   ```

---

## üîß –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞ - –§–∞–∑–∏

### **–§–∞–∑–∞ 1: Data Loading (2-3 –Ω–µ–¥–µ–ª–∏)**
```
kb/Raw_Files/
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ import_taric.py          ‚Üí TariffCodes —Ç–∞–±–µ–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ import_regulations.py    ‚Üí CustomsRegulations —Ç–∞–±–µ–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ extract_rules.py         ‚Üí DeclarationRules —Ç–∞–±–µ–ª–∞ (manual parsing)
‚îÇ   ‚îî‚îÄ‚îÄ parse_codelists.py       ‚Üí CodeLists —Ç–∞–±–µ–ª–∞
‚îÇ
‚îî‚îÄ‚îÄ processed/
    ‚îú‚îÄ‚îÄ taric.json               ‚Üí 10K+ —Ç–∞—Ä–∏—Ñ–∏
    ‚îú‚îÄ‚îÄ regulations.json         ‚Üí 1.8K —Ä–µ–≥—É–ª–∞—Ç–∏–≤–∏
    ‚îú‚îÄ‚îÄ rules.json               ‚Üí 100+ –≤–∞–ª–∏–¥–∞—Ü–∏—Å–∫–∏ –ø—Ä–∞–≤–∏–ª–∞
    ‚îî‚îÄ‚îÄ codelists.json           ‚Üí 20+ –ª–∏—Å—Ç–∏ (countries, procedures, documents...)
```

**–ó–∞–¥–∞—á–∏**:
- ‚úÖ Parse Excel —Ñ–∞—ò–ª–æ–≤–∏ (openpyxl)
- ‚úÖ Extract rules –æ–¥ PDF (PyPDF2 + regex + manual review)
- ‚úÖ Seed –≤–æ –±–∞–∑–∞ (EF Core migration)

---

### **–§–∞–∑–∞ 2: Rule Engine (2 –Ω–µ–¥–µ–ª–∏)**
```csharp
// LON.Application/Customs/Rules/
‚îú‚îÄ‚îÄ IDeclarationRule.cs
‚îú‚îÄ‚îÄ RequiredFieldRule.cs
‚îú‚îÄ‚îÄ FormatValidationRule.cs
‚îú‚îÄ‚îÄ TariffValidationRule.cs
‚îú‚îÄ‚îÄ ProcedureDocumentRule.cs
‚îî‚îÄ‚îÄ CrossFieldValidationRule.cs

// Usage in Command Handler:
public async Task<Result> Handle(CreateDeclarationCommand request)
{
    var rules = _ruleRepository.GetActiveRules();
    var validationResult = _ruleEngine.Validate(request.Declaration, rules);
    
    if (!validationResult.IsValid)
        return Result.Failure(validationResult.Errors);
    
    // Continue with declaration creation...
}
```

---

### **–§–∞–∑–∞ 3: Vector Store + RAG (3 –Ω–µ–¥–µ–ª–∏)**
```
kb/
‚îú‚îÄ‚îÄ embeddings/
‚îÇ   ‚îú‚îÄ‚îÄ chunks/                  ‚Üí JSON chunks –æ–¥ PDF
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pravilnik_001.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pravilnik_002.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ vectordb/                ‚Üí pgvector –∏–ª–∏ ChromaDB
‚îÇ
‚îî‚îÄ‚îÄ scripts/
    ‚îú‚îÄ‚îÄ chunk_documents.py       ‚Üí Split PDF into semantic chunks
    ‚îú‚îÄ‚îÄ generate_embeddings.py   ‚Üí OpenAI API –∏–ª–∏ sentence-transformers
    ‚îî‚îÄ‚îÄ ingest_vectors.py        ‚Üí Store in vector DB
```

**API Integration**:
```csharp
// LON.Application/Customs/Queries/GetContextualHelpQuery.cs
public class GetContextualHelpQuery : IRequest<string>
{
    public string BoxNumber { get; set; }
    public string UserQuestion { get; set; }
    public CustomsDeclaration? CurrentDeclaration { get; set; }
}

// Handler uses:
// 1. Vector search –∑–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏ chunks
// 2. GPT-4 –∑–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞—ö–µ –æ–¥–≥–æ–≤–æ—Ä —Å–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç
// 3. Citation –ª–∏–Ω–∫–æ–≤–∏ –∫–æ–Ω –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏
```

---

### **–§–∞–∑–∞ 4: UI Integration (2 –Ω–µ–¥–µ–ª–∏)**
```typescript
// frontend/web/src/components/customs/SmartDeclarationForm.tsx

// Real-time validation tooltip
<InputField
  name="box33_commodity_code"
  onBlur={(value) => validateField('box33', value)}
  helpText={<AIAssistant boxNumber="33" />}
/>

// AI Assistant sidebar
<Sidebar>
  <ChatBot 
    context={currentDeclaration}
    knowledgeBase="customs"
  />
</Sidebar>

// Warnings panel
<ValidationPanel>
  {warnings.map(w => (
    <Alert severity={w.severity}>
      {w.message}
      <Link to={w.referenceDoc}>–ü–æ–≤–µ—ú–µ...</Link>
    </Alert>
  ))}
</ValidationPanel>
```

---

## üìä –û—á–µ–∫—É–≤–∞–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏

### –ö–≤–∞–ª–∏—Ç–∞—Ç–∏–≤–Ω–∏:
- ‚úÖ **100% compliance** —Å–æ –ø—Ä–∞–≤–∏–ª–Ω–∏–∫ –∑–∞ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç—Å–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞** –Ω–∞ —Å–∏—Ç–µ 54 –±–æ–∫—Å–∞
- ‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–Ω–∞ –ø–æ–º–æ—à** –Ω–∞ –º–∞–∫–µ–¥–æ–Ω—Å–∫–∏ —ò–∞–∑–∏–∫
- ‚úÖ **–ù–∞–º–∞–ª—É–≤–∞—ö–µ –Ω–∞ –≥—Ä–µ—à–∫–∏** –∑–∞ 70-80%
- ‚úÖ **–ó–∞–±—Ä–∑—É–≤–∞—ö–µ –Ω–∞ –ø—Ä–æ—Ü–µ—Å** - –æ–¥ 30 –º–∏–Ω –Ω–∞ 10 –º–∏–Ω

### –ö–≤–∞–Ω—Ç–∏—Ç–∞—Ç–∏–≤–Ω–∏:
- 10,307 —Ç–∞—Ä–∏—Ñ–Ω–∏ –æ–∑–Ω–∞–∫–∏ –≤–æ –±–∞–∑–∞ (–æ–¥ TARIC)
- 1,809 —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ —Ä–µ–≥—É–ª–∞—Ç–∏–≤–∏ (–æ–¥ Spisok na Regulativi)
- 100+ –≤–∞–ª–∏–¥–∞—Ü–∏—Å–∫–∏ –ø—Ä–∞–≤–∏–ª–∞ (–æ–¥ –ø—Ä–∞–≤–∏–ª–Ω–∏–∫)
- 20+ –∫–æ–¥ –ª–∏—Å—Ç–∏ (procedure codes, document types, countries...)
- 168 —Å—Ç—Ä–∞–Ω–∏—Ü–∏ –ø—Ä–∞–≤–∏–ª–Ω–∏–∫ ‚Üí ~500 semantic chunks

---

## üöÄ –°–ª–µ–¥–Ω–∏ —á–µ–∫–æ—Ä–∏

1. **–û–¥–ª—É—á–∏ –∑–∞ AI provider**:
   - OpenAI API (–ø–ª–∞—Ç–µ–Ω–∞, –Ω–∞—ò–¥–æ–±—Ä–∞ –∫–≤–∞–ª–∏—Ç–µ—Ç)
   - Azure OpenAI (enterprise, compliance)
   - –õ–æ–∫–∞–ª–µ–Ω –º–æ–¥–µ–ª (llama.cpp, Ollama - –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –Ω–æ –ø–æ–±–∞–≤–æ)

2. **Vector DB –∏–∑–±–æ—Ä**:
   - pgvector (PostgreSQL extension) - –Ω–∞—ò–ª–µ—Å–Ω–æ –∞–∫–æ –≤–µ—ú–µ –∏–º–∞ Postgres
   - Azure AI Search - —Ü–µ–ª–æ—Å–Ω–æ —É–ø—Ä–∞–≤—É–≤–∞–Ω–∞
   - ChromaDB - lightweight, open-source

3. **Priority**:
   - –§–∞–∑–∞ 1 (Data Loading) - **HIGHEST** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω–∏ –ø–æ–¥–∞—Ç–æ—Ü–∏ —Å–µ –∫—Ä–∏—Ç–∏—á–Ω–∏
   - –§–∞–∑–∞ 2 (Rule Engine) - **HIGH** - compliance –µ must-have
   - –§–∞–∑–∞ 3 (Vector Store) - **MEDIUM** - nice-to-have, AI assistant
   - –§–∞–∑–∞ 4 (UI) - **MEDIUM** - –∫–æ—Ä–∏—Å–Ω–∏—á–∫–æ –∏—Å–∫—É—Å—Ç–≤–æ

–®—Ç–æ –º–∏—Å–ª–∏—à? –î–∞–ª–∏ –¥–∞ –ø–æ—á–Ω–µ–º–µ —Å–æ –§–∞–∑–∞ 1 - –ø—Ä–µ–±—Ä—É–≤–∞—ö–µ –Ω–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏—Ç–µ –æ–¥ Excel –∏ –∫—Ä–µ–∏—Ä–∞—ö–µ –Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–∏?
